<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="AI/Local Food Team">
<meta name="dcterms.date" content="2023-06-30">

<title>DSPG 2023 - AI Local Foods Team Week Seven Wrap Up</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">DSPG 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../allBlogs.html" rel="" target="">
 <span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">Project Participants</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">AI Local Foods Team Week Seven Wrap Up</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Week Seven</div>
                <div class="quarto-category">Local Foods Team</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>AI/Local Food Team </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ai-and-local-food-team-plans-to-produce-following-outputs-at-the-end-of-this-years-project" id="toc-ai-and-local-food-team-plans-to-produce-following-outputs-at-the-end-of-this-years-project" class="nav-link active" data-scroll-target="#ai-and-local-food-team-plans-to-produce-following-outputs-at-the-end-of-this-years-project"><strong>AI and local Food team plans to produce following outputs at the end of this year’s project:</strong></a>
  <ul class="collapse">
  <li><a href="#price-analysis" id="toc-price-analysis" class="nav-link" data-scroll-target="#price-analysis"><strong>Price Analysis:</strong></a></li>
  <li><a href="#weight-analysis" id="toc-weight-analysis" class="nav-link" data-scroll-target="#weight-analysis"><strong>Weight Analysis:</strong></a></li>
  <li><a href="#brand-analysis" id="toc-brand-analysis" class="nav-link" data-scroll-target="#brand-analysis"><strong>Brand Analysis:</strong></a></li>
  <li><a href="#organic-and-local-analysis" id="toc-organic-and-local-analysis" class="nav-link" data-scroll-target="#organic-and-local-analysis"><strong>Organic and Local Analysis:</strong></a></li>
  </ul></li>
  <li><a href="#several-web-scrapping-spiders-for-selected-websites-to-facilitate-the-creation-of-a-comprehensive-product-database." id="toc-several-web-scrapping-spiders-for-selected-websites-to-facilitate-the-creation-of-a-comprehensive-product-database." class="nav-link" data-scroll-target="#several-web-scrapping-spiders-for-selected-websites-to-facilitate-the-creation-of-a-comprehensive-product-database."><strong>Several web-scrapping spiders for selected websites to facilitate the creation of a comprehensive product database.</strong></a></li>
  <li><a href="#showcase-the-capability-of-the-spiders-with-a-specific-crop-example." id="toc-showcase-the-capability-of-the-spiders-with-a-specific-crop-example." class="nav-link" data-scroll-target="#showcase-the-capability-of-the-spiders-with-a-specific-crop-example."><strong>Showcase the capability of the spiders with a specific crop example.</strong></a></li>
  <li><a href="#optimization-of-the-crop-flow-from-the-point-of-supply-to-the-point-of-demand-that-maximizes-overall-profit" id="toc-optimization-of-the-crop-flow-from-the-point-of-supply-to-the-point-of-demand-that-maximizes-overall-profit" class="nav-link" data-scroll-target="#optimization-of-the-crop-flow-from-the-point-of-supply-to-the-point-of-demand-that-maximizes-overall-profit"><strong>Optimization of the crop flow, from the point of supply to the point of demand that maximizes overall profit</strong></a></li>
  <li><a href="#demand-and-supply-estimation" id="toc-demand-and-supply-estimation" class="nav-link" data-scroll-target="#demand-and-supply-estimation"><strong>Demand and supply estimation</strong></a>
  <ul class="collapse">
  <li><a href="#demand-estimation" id="toc-demand-estimation" class="nav-link" data-scroll-target="#demand-estimation"><strong>Demand Estimation:</strong></a></li>
  <li><a href="#supply-estimation" id="toc-supply-estimation" class="nav-link" data-scroll-target="#supply-estimation"><strong>Supply Estimation:</strong></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="ai-and-local-food-team-plans-to-produce-following-outputs-at-the-end-of-this-years-project" class="level2">
<h2 class="anchored" data-anchor-id="ai-and-local-food-team-plans-to-produce-following-outputs-at-the-end-of-this-years-project"><strong>AI and local Food team plans to produce following outputs at the end of this year’s project:</strong></h2>
<p><strong>A comprehensive map to showcase the prices of eggs and bacon across various counties using the collected data.</strong> This map serves as a valuable tool for identifying trends and patterns in pricing, as well as understanding customer preferences towards specific brands. Additionally, the map aids in the selection of suitable selling locations by considering crucial factors such as brand reputation, pricing, and travel distance (cost).</p>
<p><strong>Several web-scrapping spiders for selected websites to facilitate the creation of a comprehensive product database.</strong> These spiders will automate the process of data scraping, enabling repetitive and efficient collection of data.</p>
<p><strong>Showcase the capability of the spiders with a specific crop example.</strong> The spiders will be utilized to extract data for one or more of the following six products: tomatoes (regardless of the type), carrots, green onions, potatoes, spinach, lettuce. This demonstration will effectively highlight the functionality and effectiveness of the spiders in retrieving the desired data.</p>
<p><strong>Optimization of the crop flow, from the point of supply to the point of demand that maximizes overall profit.</strong> We will explore the factors and methodology to estimate the demand and supply.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week-7.gif" class="img-fluid figure-img" width="270"></p>
</figure>
</div>
<p><strong>This week’s tasks:</strong></p>
<ul>
<li>Consolidated all scraped data from all different websites into one master file to be used for data analysis.</li>
<li>Data Analysis:
<ol type="1">
<li>Imported necessary packages in Juypter Notebook for data analysis.</li>
<li>Started cleaning the data: Missing values, fixing datatypes</li>
<li>Started exploring the data using various visualizations.</li>
</ol></li>
</ul>
<section id="data-consolidation" class="level4">
<h4 class="anchored" data-anchor-id="data-consolidation"><strong>Data Consolidation</strong></h4>
<p>Consolidated all collected data in three master lists of Eggs, Bacon and Heirloom tomato respectively. This would let work separately on each product’s data set and would give us more insights about the dataset.</p>
</section>
<section id="data-analysis" class="level4">
<h4 class="anchored" data-anchor-id="data-analysis"><strong>Data Analysis</strong></h4>
<p>Started the data analysis by importing the necessary packages, we will keep adding more packages as we go along with analysis part.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog 2.PNG" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Cleaning:</p>
<p>We found there were a lot of missing values in our data set for various columns</p>
<ol type="1">
<li><img src="images/blog 3.PNG" class="img-fluid" width="258"></li>
</ol>
<p>We dealt with missing values for filling NA like shown in the snapshot below:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog4.PNG" class="img-fluid figure-img" width="460"></p>
</figure>
</div>
</section>
<section id="price-analysis" class="level3">
<h3 class="anchored" data-anchor-id="price-analysis"><strong>Price Analysis:</strong></h3>
<p>we can analyze the relationship between the current price and the original price of the heirloom tomatoes.</p>
<p>This analysis can help you understand the pricing trends and calculate potential discounts or price differences.</p>
<p>Visualize the distribution of current prices using histograms, box plots, or kernel density plots to gain insights into the pricing range and identify any outliers.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog5.PNG" class="img-fluid figure-img" width="528"></p>
</figure>
</div>
</section>
<section id="weight-analysis" class="level3">
<h3 class="anchored" data-anchor-id="weight-analysis"><strong>Weight Analysis:</strong></h3>
<p>Analyze the weight of the heirloom tomatoes by comparing the weight in pounds and the true weight.</p>
<p>This analysis can help you determine if there are any variations in weight and assess the accuracy of weight measurements.</p>
<p>Creating scatter plots or line plots to visualize the relationship between weight in pounds and true weight.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog6-01.PNG" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</section>
<section id="brand-analysis" class="level3">
<h3 class="anchored" data-anchor-id="brand-analysis"><strong>Brand Analysis:</strong></h3>
<p>Analyze the different brands of heirloom tomatoes available in the dataset. Calculate the frequency of each brand to determine the most popular ones.</p>
<p>Creating a bar chart and pie chart to visualize the distribution of brands and identify the market share of each brand.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog7.PNG" class="img-fluid figure-img" width="561"></p>
</figure>
</div>
</section>
<section id="organic-and-local-analysis" class="level3">
<h3 class="anchored" data-anchor-id="organic-and-local-analysis"><strong>Organic and Local Analysis:</strong></h3>
<p>Analyze the presence of organic and locally sourced heirloom tomatoes. Calculate the percentage of organic and local products in the dataset. Creating a bar chart or pie chart to visualize the proportion of organic and local tomatoes.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/blog8.PNG" class="img-fluid figure-img" width="616"></p>
</figure>
</div>
</section>
</section>
<section id="several-web-scrapping-spiders-for-selected-websites-to-facilitate-the-creation-of-a-comprehensive-product-database." class="level2">
<h2 class="anchored" data-anchor-id="several-web-scrapping-spiders-for-selected-websites-to-facilitate-the-creation-of-a-comprehensive-product-database."><strong>Several web-scrapping spiders for selected websites to facilitate the creation of a comprehensive product database.</strong></h2>
<p>To facilitate the creation of a comprehensive product database, we have developed several web-scraping spiders for websites such as<br>
1. Fresh Thyme<br>
2. Hy-Vee<br>
3. Gateway Market<br>
4. New Pioneer Co-op<br>
5. Russ’s Market<br>
6. Iowa Food Hub<br>
7. Joia Food Farm</p>
<p>These spiders automate the data scraping process, eliminating the need for repetitive data collection and significantly increasing our efficiency. It’s important to note that this list is not exhaustive, as our web-scraping spiders can be expanded to include other websites beyond those listed here.</p>
</section>
<section id="showcase-the-capability-of-the-spiders-with-a-specific-crop-example." class="level2">
<h2 class="anchored" data-anchor-id="showcase-the-capability-of-the-spiders-with-a-specific-crop-example."><strong>Showcase the capability of the spiders with a specific crop example.</strong></h2>
<p>It’s worth noting that the capability of these spiders is not limited to a specific product type; they can be utilized to extract data from a wide selection of products. As an example, we have successfully demonstrated their functionality and effectiveness in retrieving data for various products, including specific crops such as tomatoes, carrots, green onions, potatoes, spinach, lettuce, and many more.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ExampleOfProductsCollected.PNG" class="img-fluid figure-img" width="189"></p>
</figure>
</div>
<p>Moreover, these spiders can be further enhanced to automate the data cleaning processes which runs concurrently within the spider. This approach allows us to efficiently address data quality issues, ensuring that the collected data is reliable and ready for analysis. The main objective of this enhancement is to guarantee that the collected data is thoroughly cleaned before integrating it into a file format, providing a seamless transition for further analysis and utilization. This specific example Highlights Heirloom Tomatoes from the listed stores as mention above.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/ExampleOfCleanedProducts.PNG" class="img-fluid figure-img" width="488"></p>
</figure>
</div>
</section>
<section id="optimization-of-the-crop-flow-from-the-point-of-supply-to-the-point-of-demand-that-maximizes-overall-profit" class="level2">
<h2 class="anchored" data-anchor-id="optimization-of-the-crop-flow-from-the-point-of-supply-to-the-point-of-demand-that-maximizes-overall-profit"><strong>Optimization of the crop flow, from the point of supply to the point of demand that maximizes overall profit</strong></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Figure_1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ol type="1">
<li><p>The red points represent the counties.</p></li>
<li><p>The green lines represent the flow of crops, and the blue arrow shows the direction of the flow.</p></li>
<li><p>Maximizes the revenue by selling the crops.</p></li>
<li><p>Minimizes the cost of distance traveled.</p></li>
<li><p>Relaxed previous assumption “Supply is greater than demand”</p></li>
</ol>
<p>The following might be included in the project:</p>
<ol type="1">
<li><p>A separate account of fresh and not fresh products.</p></li>
<li><p>Consideration of each individual farmer’s profit.</p></li>
<li><p>Consideration of the flow of trucks rather than the flow of crops.</p></li>
</ol>
</section>
<section id="demand-and-supply-estimation" class="level2">
<h2 class="anchored" data-anchor-id="demand-and-supply-estimation"><strong>Demand and supply estimation</strong></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Capture.PNG" class="img-fluid figure-img" width="653"></p>
</figure>
</div>
<p><strong>Disclaimer:</strong> Supply and demand estimation requires further correction, and the methodology needs improvements.</p>
<p><img src="images/Figure_2.png" class="img-fluid"></p>
<section id="demand-estimation" class="level3">
<h3 class="anchored" data-anchor-id="demand-estimation"><strong>Demand Estimation:</strong></h3>
<ol type="1">
<li><p>The population of United States is 334.9 million as of June 26, 2023. (<a href="https://www.census.gov/popclock/" class="uri">https://www.census.gov/popclock/</a>)</p></li>
<li><p>In 2017, fresh market consumption was 20.3 pounds per capita. (<a href="https://www.agmrc.org/commodities-products/vegetables/tomatoes" class="uri">https://www.agmrc.org/commodities-products/vegetables/tomatoes</a>)</p></li>
<li><p>So, the demand for fresh tomatoes in the United States is (334.9 million x 20.3 pounds) or 3.08 Million Metric Tons.</p></li>
<li><p>There is around 1% of the US population lives in Iowa.</p></li>
<li><p>That translates to 30.8 thousand Metric Tons of tomatoes demand in Iowa.</p></li>
<li><p>Considering the demand for tomatoes stays the same for 52 weeks. The demand for tomatoes in Iowa per week is 592 Metric Tons.</p></li>
<li><p>We will allocate this demand to each county of Iowa by population.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Capture2.PNG" class="img-fluid figure-img" width="615"></p>
</figure>
</div>
</section>
<section id="supply-estimation" class="level3">
<h3 class="anchored" data-anchor-id="supply-estimation"><strong>Supply Estimation:</strong></h3>
<ol type="1">
<li><p>The growing season of tomatoes is between May to Mid-September in Iowa. (<a href="https://www.tomatofest.com/Tomato_Growing_Zone_Maps_s/164.htm" class="uri">https://www.tomatofest.com/Tomato_Growing_Zone_Maps_s/164.htm</a>)</p></li>
<li><p>We have 135 days between planting and harvesting tomatoes.</p></li>
<li><p>Tomatoes require 100 days to fully mature. However, there are some special varieties of tomatoes that require 50-60 days to mature. &nbsp;(<a href="https://www.gardeningknowhow.com/edible/vegetables/tomato/planting-time-for-tomatoes.htm" class="uri">https://www.gardeningknowhow.com/edible/vegetables/tomato/planting-time-for-tomatoes.htm</a>)</p></li>
<li><p>So, we are considering on average tomatoes take 80 days to be harvested.</p></li>
<li><p>In this context, we assumed that being mature represents the time between sowing seed and harvesting full-grown tomatoes.</p></li>
<li><p>We are only considering single cultivation of tomatoes during a year.</p></li>
<li><p>So, the tomatoes will be harvested during the timeline day 80-135 or, during late July to mid-September, that is 7.85 or 8 weeks.&nbsp;</p></li>
<li><p>In our calculations, we will estimate the weekly supply of tomatoes from late July to mid-September.</p></li>
<li><p>In 2020, approximately 12,619.2 tons of fresh market tomatoes were harvested from approximately 272,900 acres. (<a href="https://www.agmrc.org/commodities-products/vegetables/tomatoes" class="uri">https://www.agmrc.org/commodities-products/vegetables/tomatoes</a>)</p></li>
<li><p>Florida and California account for about two-thirds of the national fresh tomato production (Wu, F., Guan, Z., &amp; Suh, D. H. (2017). The Effects of Tomato Suspension Agreements on Market Price Dynamics.; mentioned in <a href="https://edis.ifas.ufl.edu/publication/FE1027" class="uri">https://edis.ifas.ufl.edu/publication/FE1027</a>)</p></li>
<li><p>The remaining 48 states are responsible for one-third of the national fresh tomatoes. That is 4206.4 tons.</p></li>
<li><p>Total farming land in USA is 900.21 million acres as of 2022.<br>
Total farm land in Florida is 9.73 million acres as of 2017.<br>
Total farm land in California is 24.23 million acres as of 2017.<br>
&nbsp;(<a href="https://www.nass.usda.gov/AgCensus" class="uri">https://www.nass.usda.gov/AgCensus</a>)</p></li>
<li><p>Remaining 48 states have a farm land of 866.25 million acres.</p></li>
<li><p>Total farmland in Iowa is 30.56 million acres. (<a href="https://www.nass.usda.gov/AgCensus" class="uri">https://www.nass.usda.gov/AgCensus</a>)</p></li>
<li><p>Considering tomatoes are grown uniformly in these farmlands, the proportion of farmland Iowa has compared to all 48 states (without California, Florida) is 3.52%.</p></li>
<li><p>The production of tomatoes in Iowa is (3.52% x 4206.4 tons) or, 148 tons.</p></li>
<li><p>As the production of tomatoes is distributed over 8 weeks (as mentioned in no 8), the weekly supply quantity of tomatoes is (148/8) or 18.5 tons or 16.78 Metric Tons.</p></li>
<li><p>Considering the average farm size in each county of Iowa is the same. The supply of tomatoes can be obtained from the number of farms.</p></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/capture3.PNG" class="img-fluid figure-img" width="415"></p>
</figure>
</div>
<p>Teaser video: <video src="Local_food_teaser.mp4" class="img-fluid" controls=""><a href="Local_food_teaser.mp4">Video</a></video></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>
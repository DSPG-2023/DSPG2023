<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kailyn Hogan">
<meta name="dcterms.date" content="2023-06-30">

<title>DSPG 2023 - Housing Team Week Seven Wrap Up</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">DSPG 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../allBlogs.html" rel="" target="">
 <span class="menu-text">Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target="">
 <span class="menu-text">Project Participants</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Housing Team Week Seven Wrap Up</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Week Seven</div>
                <div class="quarto-category">Housing Team</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kailyn Hogan </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-seven-for-the-housing-team" id="toc-week-seven-for-the-housing-team" class="nav-link active" data-scroll-target="#week-seven-for-the-housing-team">Week Seven for the Housing Team</a></li>
  <li><a href="#ai-driven-housing-evaluation-for-rural-community-development" id="toc-ai-driven-housing-evaluation-for-rural-community-development" class="nav-link" data-scroll-target="#ai-driven-housing-evaluation-for-rural-community-development">AI-Driven Housing Evaluation for Rural Community Development</a>
  <ul class="collapse">
  <li><a href="#demographic-analysis" id="toc-demographic-analysis" class="nav-link" data-scroll-target="#demographic-analysis">Demographic Analysis</a></li>
  <li><a href="#ai-models" id="toc-ai-models" class="nav-link" data-scroll-target="#ai-models">AI Models</a></li>
  <li><a href="#geospatial-mapping" id="toc-geospatial-mapping" class="nav-link" data-scroll-target="#geospatial-mapping">Geospatial Mapping</a></li>
  <li><a href="#next-steps" id="toc-next-steps" class="nav-link" data-scroll-target="#next-steps">Next Steps</a></li>
  <li><a href="#final-presentation-outline" id="toc-final-presentation-outline" class="nav-link" data-scroll-target="#final-presentation-outline">Final Presentation Outline</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="week-seven-for-the-housing-team" class="level2">
<h2 class="anchored" data-anchor-id="week-seven-for-the-housing-team">Week Seven for the Housing Team</h2>
<p><em>For more detailed information on what each member of the housing team has accomplished thus far, check out their individual blog pages. Links are embedded in their specific sections.</em></p>
</section>
<section id="ai-driven-housing-evaluation-for-rural-community-development" class="level1">
<h1>AI-Driven Housing Evaluation for Rural Community Development</h1>
<p>Hello! Welcome to week seven of Data Science for the Public Good for the Housing Team. We have made a lot of progress in the past seven weeks, and we are excited to share it with you!</p>
<p>First up, the teaser video!</p>
<p>We made a short YouTube video this week to tease the upcoming final presentation for DSPG on July 14th. The final presentation will be held in the room 0114 of the Student Innovation Center on Iowa State University’s campus from 8:30 AM -12:00 PM. Attendees can join <a href="https://iastate.zoom.us/j/96296249454?pwd=NWZ2UVlHaDVpWm5Rc2JCeVh3K25JZz09">virtually via Zoom</a> or in person. Click <a href="#0">here</a> for more information.</p>
<section id="demographic-analysis" class="level3">
<h3 class="anchored" data-anchor-id="demographic-analysis">Demographic Analysis</h3>
<p>The Housing Team recently introduced a new section to their project: a demographics section. Demographic profiles for Grundy Center, Independence, and New Hampton were created last week. This week the focus was shifted to analysis. One of our objectives is to determine which communities in Iowa have the most need for our project, thus we are conducting a demographic analysis.</p>
<p>We are covering the following characteristics of communities within our analysis:</p>
<ul>
<li><p>population</p></li>
<li><p>housing</p></li>
<li><p>income</p></li>
<li><p>jobs and the workforce</p></li>
</ul>
<p>Most of our data is coming from the 2000-2020 Decennial Census or the 2021 5-Year American Community Survey. Additional data sources can be found <a href="https://lehd.ces.census.gov/data/">here</a> and <a href="https://data.iowa.gov/Local-Government-Finance/Taxable-Property-Values-in-Iowa-by-Tax-District-an/ig9g-pba5">here</a>.</p>
<p>The Housing Team was able to make some strides with the demographic analysis this week and compile gathered data into a larger CSV file.</p>
<p>Find more information on the Demographic Analysis process by clicking the link <a href="https://kailynhogan.github.io/Kailyn_Hogan_DSPG_Blog/">here</a>.</p>
</section>
<section id="ai-models" class="level3">
<h3 class="anchored" data-anchor-id="ai-models">AI Models</h3>
<p>To start this section off, I would like to recap out AI Model progress. In total we have seven different AI Models all testing images for the conditions of different house characteristics. The models are listed below:</p>
<ul>
<li><p>house present</p></li>
<li><p>clear image</p></li>
<li><p>multiple houses</p></li>
<li><p>vegetation</p></li>
<li><p>roof</p></li>
<li><p>gutter</p></li>
<li><p>siding</p></li>
</ul>
<p>The last four AI Models – vegetation, roof, gutter, and siding – are aided by the WINVEST project. The entirety of DSPG collected data on the conditions of Grundy Center, Independence, and New Hampton houses’ vegetation, roof, gutter, and siding through WINVEST.</p>
<p>As of this week, with the completion of the roof and gutter models, all AI Models are finished. Next is training.</p>
<section id="image-sorting-for-model-training" class="level4">
<h4 class="anchored" data-anchor-id="image-sorting-for-model-training"><strong>Image Sorting for Model Training</strong></h4>
<p>The Housing Team was able to add WINVEST photos into our image collection this week. We specifically filtered the WINVEST data sets to only download the images associated with <em>poor</em> characteristics. This was done because we need more images of bad houses to accurately train our models. We have enough images of good houses at this point.</p>
<p>Below is a diagram detailing the image storage solution we are managing for our AI Models.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/gavin_image_storage.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>An image sorting algorithm was created to sort each image by address and create an associated folder. Images from all sources (Google, Zillow, WINVEST) can be stored in the same folder and run through the AI Model together.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/address_image_folder.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="storing-ai-model-outputs" class="level4">
<h4 class="anchored" data-anchor-id="storing-ai-model-outputs">Storing AI Model Outputs</h4>
<p>Last week, code was written to take the outputs of the AI Model and write them to a CSV file. Last weeks version was simply a test, but, as of this week, we are able to write the outputs to the CSV file officially.</p>
<p>Find more information on the AI Model creation process by clicking the link <a href="https://gavinfishy.github.io/Gavin_DSPG_Blog/">here</a>.</p>
</section>
</section>
<section id="geospatial-mapping" class="level3">
<h3 class="anchored" data-anchor-id="geospatial-mapping">Geospatial Mapping</h3>
<p>We are using the CSV file with the outputs of the AI Models to map the conditions of housing each city. To do this, we are using Tableau.</p>
<p>The better part of this week has been spent learning how to use Tableau and dealing with complications in downloading. The below map was created in Tableau Public and shows the conditions of siding in New Hampton, Iowa. With the data that is currently available, we can see that that majority of siding conditions in New Hampton are poor.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/New_hampton_siding_map_draft.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Find more information on the Geospatial Mapping process by clicking the link <a href="https://1angelinaevans.github.io/AngelinaEvansBlog/">here</a>.</p>
</section>
<section id="next-steps" class="level3">
<h3 class="anchored" data-anchor-id="next-steps">Next Steps</h3>
<p>Listed below is what the Housing Team plans to accomplish over the next two weeks before our final presentation:</p>
<ul>
<li><p>Further train AI Models to provide a more accurate evaluation of housing conditions</p></li>
<li><p>Build Heatmap to determine where AI Models are basing evaluation</p></li>
<li><p>Update demographic profile graphs to include state, regional, and national comparisons</p></li>
<li><p>Analyze demographic profiles to determine patterns and trends between Grundy Center, Independence, and New Hampton</p></li>
<li><p>Visualize the demographic analysis data using Tableau</p></li>
<li><p>Determine communities that could benefit from our project</p></li>
<li><p>Further analyze in-need communities</p></li>
<li><p>Visualize the outputs of the AI Models geospatially using Tableau</p></li>
<li><p>Analyse Tableau visualizations and show findings</p></li>
<li><p>Compare housing conditions in Grundy Center, Independence, and New Hampton using Tableau visualizations</p></li>
</ul>
<p>To wrap up this week, we generated an outline for our final presentation. Section titles, speakers, main points, and time allotted are listed in the table below. Note, this a draft of the final presentation. It is subject to change.</p>
</section>
<section id="final-presentation-outline" class="level2">
<h2 class="anchored" data-anchor-id="final-presentation-outline">Final Presentation Outline</h2>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 71%">
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>SPEAKER</strong></td>
<td><strong>SECTION</strong></td>
<td><strong>TIME</strong></td>
</tr>
<tr class="even">
<td>Morenike</td>
<td><p>&nbsp;<strong>Introduction</strong></p>
<ol type="1">
<li>Overview of the project objectives and goals</li>
<li>Importance of data collection and analysis in real estate and community analysis</li>
</ol></td>
<td>2 min</td>
</tr>
<tr class="odd">
<td>Angelina and Kailyn</td>
<td><p><strong>Data Collection</strong></p>
<p><em>Scraping from Beacon and Vanguard</em></p>
<ol type="1">
<li>Brief explanation of Beacon and Vanguard as data sources</li>
<li>Scraping process</li>
<li>Importance of obtaining accurate and reliable data from these sources</li>
</ol>
<p><em>Address Cleaning and Google Links</em></p>
<ol type="1">
<li><p>Address cleaning and standardization techniques</p></li>
<li><p>Utilizing Google links for Google Street View image retrieval</p></li>
<li><p>Reasons for having accurate and complete address data</p>
<p><em>Scraping from Google Street View</em></p></li>
<li><p>Extracting street view images for AI model use</p></li>
<li><p>Techniques used for automated data extraction from Google Street View</p></li>
</ol>
<p>S<em>craping from Zillow</em></p>
<ol type="1">
<li>Introduction to Zillow as a real estate data source</li>
<li>Extracting relevant property data from Zillow</li>
<li>Challenges and limitations of scraping from Zillow</li>
</ol></td>
<td>5 min</td>
</tr>
<tr class="even">
<td><p>Gavin</p>
<p><em>Angelina and Kailyn on Manual Image Sorting</em></p></td>
<td><p><strong>AI Model Creation</strong></p>
<p><em>Only displaying images for one of the models. Note in presentation the ones that do exist, but we are using only one model to refine presentation.</em></p>
<p><em>Manual Image Sorting to Train Models</em></p>
<ol type="1">
<li>Techniques used for organizing and categorizing the obtained images</li>
<li>Purpose of image sorting</li>
</ol>
<p><em>Building AI Models</em> <em>(Binary and Multiple)</em></p>
<ol type="1">
<li>Keras and Tensorflow Libraries</li>
<li>Refining image data</li>
<li>AI has to be able to easily read the images</li>
<li>Identify Labels (Binary vs.&nbsp;Multiple)</li>
<li>Split Training, Testing, and Evaluating Data</li>
<li>Build Layers</li>
<li>Train the AI Models</li>
<li>Evaluate</li>
<li>Export</li>
</ol></td>
<td>10 min</td>
</tr>
<tr class="odd">
<td>Gavin</td>
<td><strong>The Thing Gavin Made that Writes to a CSV</strong></td>
<td>8 min</td>
</tr>
<tr class="even">
<td>Kailyn</td>
<td><p><strong>Demographic Analysis and Profiling</strong></p>
<p><em>Select Communities</em></p>
<ol type="1">
<li>Key findings and insights regarding population, age groups, etc.</li>
</ol>
<p><em>All Iowa Communities</em></p>
<ol type="1">
<li>Overview of the demographic analysis methodology</li>
<li>Comparative analysis of Iowa communities based on demographic factors</li>
<li>Visualization techniques used to present the analysis results</li>
</ol></td>
<td>6 min</td>
</tr>
<tr class="odd">
<td>Angelina</td>
<td><p><strong>Visualizing Housing Quality Data from AI Model Outputs (with GIS?)</strong></p>
<p><em>Geocoding Addresses</em></p>
<ol type="1">
<li>Explanation of geocoding process and its importance</li>
<li>Comparison of geocoding in R</li>
<li>Evaluation of advantages and limitations of each geocoding approach</li>
</ol>
<p><em>Mapping AI Model data</em></p>
<ol type="1">
<li>Application of spatial data&nbsp;for visualizing and analyzing house quality</li>
<li>Techniques used for representing house quality on maps</li>
<li>Interpretation and insights gained from geographical Analysis of house quality</li>
</ol></td>
<td>6 min</td>
</tr>
<tr class="even">
<td>Morenike</td>
<td><p><strong>Conclusion</strong></p>
<ol type="1">
<li>Summary of the project workflow and key findings</li>
<li>Lessons learned and challenges encountered</li>
<li>Future possibilities and areas for further improvement</li>
</ol></td>
<td>2 min</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Questions</strong></td>
<td>10 min</td>
</tr>
</tbody>
</table>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>